function dashboard_init(){dateCurrent=new Date,iDay=iDayCurrent=dateCurrent.getDate(),iMonth=iMonthCurrent=dateCurrent.getMonth(),iYear=iYearCurrent=dateCurrent.getFullYear(),iMonth+=1,tasks_active(),cards_active(),date_switch(iDay,iMonth,iYear)}function date_switch(a,s,t){dashboard_month(s,t),subscriptions_month(s,t),liveliner_day("get_day",a,s,t)}function date_update(a,s,t){if(a)iDay=a,$(document).find("#dashboard_day").length&&$(document).find("#dashboard_day").val(a);else{a=$(document).find("#dashboard_day").val()?$(document).find("#dashboard_day").val():1;iDay=a,$(document).find("#dashboard_day").val(a)}s?(iMonth=s,$(document).find("#dashboard_month").length&&$(document).find("#dashboard_month").val(s)):$(document).find("#dashboard_month").length?iMonth=$(document).find("#dashboard_month").val():iMonth=dateCurrent.getMonth(),t?(iMonth=s,$(document).find("#dashboard_month").length&&$(document).find("#dashboard_month").val(s)):$(document).find("#dashboard_year").length?iYear=$(document).find("#dashboard_year").val():iYear=dateCurrent.getFullYear()}function subscriptions_month(a,s){$(document).find("#dashboard_subscriptions").html(""),$.when(content_download({action:"subscriptions",form:"month",month:a,year:s},"json",!1)).then(function(t){$.each(t.subscriptions,function(t,i){if(i.paid&&!i.paid_need)return!0;sSubscriptionsHtml="",sSubscriptionsHtml+='<div class="_slider_item">',sSubscriptionsHtml+='<div class="subscription_min _slider_item_content">',sSubscriptionsHtml+='<a href="javascript:;" class="_edit content_loader_show" data-action="subscriptions" data-animate_class="animate__flipInY" data-form="form" data-full="true" data-id="'+i.id+'" data-success_click="#dashboard_reload_subscriptions">',sSubscriptionsHtml+='<i class="fa-solid fa-gear"></i>',sSubscriptionsHtml+="</a>",sSubscriptionsHtml+='<div class="_title">',sSubscriptionsHtml+=i.title,sSubscriptionsHtml+="</div>",sSubscriptionsHtml+='<div class="_sub">',sSubscriptionsHtml+='<a href="javascript:;" class="_button content_loader_show" data-action="moneys" data-animate_class="animate__flipInY" data-form="form" data-full="true" data-subscription="'+i.id+'" data-price="'+i.price+'" data-category="'+i.category+'" data-date="'+s+"-"+a+"-"+iDay+'" data-filter="true" data-success_click="#dashboard_reload_subscriptions">',sSubscriptionsHtml+='<span class="_icon"><i class="fa-solid fa-wallet"></i></span>',sSubscriptionsHtml+="</a>",i.paid||i.paid_sum>0?(sSubscriptionsHtml+='<div class="_value _check">',sSubscriptionsHtml+="<strike>"+i.price+"</strike>",i.paid_need>0?sSubscriptionsHtml+="<strong>"+i.paid_need+"</strong>":sSubscriptionsHtml+='<i class="fas fa-check"></i>',sSubscriptionsHtml+="</div>"):(sSubscriptionsHtml+='<div class="_value">',sSubscriptionsHtml+=i.price,sSubscriptionsHtml+="</div>"),sSubscriptionsHtml+="</div>",sSubscriptionsHtml+='<div class="_background">',i.category_val&&(sSubscriptionsHtml+='<div class="_color" style="background: radial-gradient('+i.category_val.color+',rgba(0,0,0,0))"></div>'),sSubscriptionsHtml+="</div>",sSubscriptionsHtml+="</div>",sSubscriptionsHtml+="</div>",$(document).find("#dashboard_subscriptions").append(sSubscriptionsHtml)}),animation_number_to($("#dashboard_subscriptions_sum"),0,t.subscriptions_sum)})}function cards_active(a,s){$(document).find("#dashboard_cards").html(""),$.when(content_download({action:"dashboards",form:"cards"},"json",!1)).then(function(a){$.each(a.cards,function(a,s){sCardHtml="",sCardHtml+='<div class="_slider_item">',sCardHtml+='<div class="block_card_min _slider_item_content">',sCardHtml+='<div class="_title">',sCardHtml+=""+s.title,sCardHtml+="<small>",sCardHtml+="#"+s.id,sCardHtml+="</small>",sCardHtml+="</div>",sCardHtml+='<div class="_sub">',sCardHtml+='<div class="_update">',sCardHtml+=s.date_update,sCardHtml+="</div>",sCardHtml+='<div class="_balance">',sCardHtml+=s.balance,sCardHtml+="</div>",sCardHtml+="</div>",sCardHtml+='<div class="_background">',sCardHtml+='<div class="_color" style="background: radial-gradient('+s.color+',rgba(0,0,0,0))"></div>',sCardHtml+="</div>",sCardHtml+="</div>",sCardHtml+="</div>",$(document).find("#dashboard_cards").append(sCardHtml)}),animation_number_to($("#dashboard_cards_balance"),0,a.balance)})}function liveliner_day(a,s,t,i){$(document).find("#dashboard_days").addClass("_loading_"),$.when(content_download({action:"dashboards",form:a,day:s,month:t,year:i},"json",!1)).then(function(d){var e="",n=24,o=0,r=0;1==s&&"prev_day"==a&&(date_update(d.day,d.month,d.year),dashboard_month(d.month,d.year),subscriptions_month(d.month,d.year)),s=d.day,t=d.month,i=d.year,e+='<div class="_liveliner_day">',e+='<div class="_line_hours"><div class="_val">'+d.times_sum+'</div><div class="_seporator">/</div><div class="_def">24</div></div>',d.moneys_sum&&(e+='<div class="_line_moneys"><div class="_val">'+d.moneys_sum+"</div></div>"),e+='<div class="block_date _date">',e+='<select name="day" class="_day form-select" id="dashboard_day">';for(var l=new Date(d.year,d.month,0).getDate(),c=1;c<=l;c++)d.day==c?e+='<option selected="selected" value="'+c+'">'+c+"</option>":e+='<option value="'+c+'">'+c+"</option>";e+="</select>",e+='<button class="_button btn" id="liveliner_reload_day" data-day="'+d.day+'" data-month="'+d.month+'" data-year="'+d.year+'" style="display:none;">',e+='<i class="fa-solid fa-rotate-right"></i>',e+="</button>",e+='<button class="_button btn" id="liveliner_prev_day" data-day="'+d.day+'" data-month="'+d.month+'" data-year="'+d.year+'">',e+='<i class="fa-solid fa-arrow-right-long"></i>',e+="</button>",e+="</div>",e+='<div class="_vals">',$.each(d.categories,function(a,s){s.moneys&&s.moneys.sum&&(r=Math.abs(s.moneys.sum)>r?Math.abs(s.moneys.sum):r)}),$.each(d.categories,function(a,d){var l=d.moneys&&0!=parseInt(d.moneys.sum)?d.moneys.sum:0,c=d.times&&0!=parseInt(d.times.sum)?d.times.sum:0;if(l||c){var m=0,_=0;c?(arrCategoryTimesSum=c.split(":"),iCategoryTimesSum=arrCategoryTimesSum[0],arrCategoryTimesSum=arrCategoryTimesSum[0]+":"+arrCategoryTimesSum[1],m=iCategoryTimesSum/24*100):(iCategoryTimesSum=2,m=iCategoryTimesSum/24*100),_=r?Math.abs(l/r*100):0,n-=iCategoryTimesSum,o+=iCategoryTimesSum,e+='<div class="_category" style="height:'+m+'%">',e+='<div class="_content">',e+='<div class="_title">'+d.title+"</div> ",0!=l&&(e+='<div class="_moneys">'+Math.round(l)+"</div>"),c&&(e+='<div class="_times">'+c+"</div>"),e+='<div class="_background_moneys" style="width:'+_+"%; background:"+d.color+';"></div>',e+='<div class="_background_times" style="background: '+d.color+'"></div>',e+="</div>",e+='<div class="_buttons">',e+='<a href="javascript:;" class="_button content_loader_show" data-action="times" data-animate_class="animate__flipInY" data-elem=".time" data-form="form" data-full="true" data-category_id="'+a+'" data-date="'+i+"-"+t+"-"+s+'" data-filter="true" data-success_click="#liveliner_reload_day">',e+='<span class="_icon"><i class="fa-solid fa-clock"></i></span>',e+="</a>",e+='<a href="javascript:;" class="_button content_loader_show" data-action="moneys" data-animate_class="animate__flipInY" data-elem=".time" data-form="form" data-full="true" data-category_id="'+a+'" data-date="'+i+"-"+t+"-"+s+'" data-filter="true" data-success_click="#liveliner_reload_day">',e+='<span class="_icon"><i class="fa-solid fa-wallet"></i></span>',e+="</a>",e+="</div>",e+="</div>"}}),e+='<div class="_category" style="min-height:'+n/24*100+'%">',e+='<div class="_content">',e+='<div class="_title">No</div> ',e+='<div class="_background_moneys" style="width: 2%; background: white;"></div>',e+='<div class="_background_times" style="background: white"></div>',e+="</div>",e+="</div>",e+="</div>",e+='<div class="_buttons">',e+='<a href="javascript:;" class="_button content_loader_show" data-action="times" data-animate_class="animate__flipInY" data-elem=".time" data-form="form" data-full="true" data-date="'+i+"-"+t+"-"+s+'" data-filter="true" data-success_click="#liveliner_reload_day">',e+='<span class="_icon"><i class="fa-solid fa-clock"></i></span>',e+="</a>",e+='<a href="javascript:;" class="_button content_loader_show" data-action="moneys" data-animate_class="animate__flipInY" data-elem=".time" data-form="form" data-full="true" data-date="'+i+"-"+t+"-"+s+'" data-filter="true" data-success_click="#liveliner_reload_day">',e+='<span class="_icon"><i class="fa-solid fa-wallet"></i></span>',e+="</a>",e+="</div>",e+="</div>",$(document).find("#dashboard_days").html(e),$(document).find("#dashboard_days").removeClass("_loading_")})}function dashboard_month(a,s){$.when(content_download({action:"dashboards",form:"main",month:a,year:s},"json",!1)).then(function(a){animation_number_to($("#dashboard_main_money_costs"),0,a.success.moneys.costs),animation_number_to($("#dashboard_main_money_wages"),0,a.success.moneys.wages),animation_number_to($("#dashboard_main_time_work"),0,a.success.times.works),animation_number_to($("#dashboard_main_time_sum"),0,a.success.times.sum),animation_number_to($("#dashboard_main_res"),0,a.success.moneyforhour)})}function tasks_active(a,s){$(document).find("#dashboard_tasks").html(""),$.when(content_download({action:"tasks",form:"active"},"json",!1)).then(function(t){$.each(t.tasks,function(t,i){sTasksHtml="",sTasksHtml+='<div class="_slider_item">',sTasksHtml+='<div class="task_min _slider_item_content">',sTasksHtml+='<a href="javascript:;" class="_edit content_loader_show" data-action="tasks" data-animate_class="animate__flipInY" data-form="form" data-full="true" data-id="'+i.id+'" data-success_click="#dashboard_reload_tasks">',sTasksHtml+='<i class="fa-solid fa-gear"></i>',sTasksHtml+="</a>",sTasksHtml+='<div class="_title">',sTasksHtml+=""+i.title,sTasksHtml+="<small>",sTasksHtml+="#"+i.id,sTasksHtml+="</small>",sTasksHtml+="</div>",sTasksHtml+='<div class="_sub">',sTasksHtml+='<div class="_status" style="background: '+i.status_color+'">',sTasksHtml+=""+i.status_val,sTasksHtml+="</div>",sTasksHtml+='<div class="_buttons">',sTasksHtml+='<a href="javascript:;" class="_button content_loader_show" data-action="times" data-animate_class="animate__flipInY" data-form="form" data-full="true" data-project_id="'+i.project.id+'" data-category_id="4" data-task_id="'+i.id+'" data-time="'+i.time+'" data-category="'+i.category+'" data-date="'+s+"-"+a+"-"+iDay+'" data-filter="true" data-success_click="#dashboard_reload_times">',sTasksHtml+='<span class="_icon"><i class="fa-solid fa-clock"></i></span>',sTasksHtml+="</a>",sTasksHtml+='<a href="javascript:;" class="_button content_loader_show" data-action="moneys" data-animate_class="animate__flipInY" data-form="form" data-full="true" data-project_id="'+i.project.id+'" data-category_id="4" data-task_id="'+i.id+'" data-price="'+i.price+'" data-category="'+i.category+'" data-date="'+s+"-"+a+"-"+iDay+'" data-filter="true" data-success_click="#dashboard_reload_times">',sTasksHtml+='<span class="_icon"><i class="fa-solid fa-wallet"></i></span>',sTasksHtml+="</a>",sTasksHtml+="</div>",sTasksHtml+='<div class="_project">',sTasksHtml+=""+i.project.title,sTasksHtml+="</div>",sTasksHtml+="</div>",sTasksHtml+="</div>",sTasksHtml+="</div>",$(document).find("#dashboard_tasks").append(sTasksHtml)})})}dateCurrent=new Date,iDay=iDayCurrent=dateCurrent.getDate(),iMonth=iMonthCurrent=dateCurrent.getMonth(),iYear=iYearCurrent=dateCurrent.getFullYear(),iMonth+=1,$(document).on("change","#dashboard_day",function(){date_update(),date_switch(iDay,iMonth,iYear)}),$(document).on("change","#dashboard_month",function(){date_update(),date_switch(iDay,iMonth,iYear)}),$(document).on("change","#dashboard_year",function(){date_update(),date_switch(iDay,iMonth,iYear)}),$(document).on("click","#liveliner_prev_day",function(){liveliner_day("prev_day",$(this).data().day,$(this).data().month,$(this).data().year)}),$(document).on("click","#liveliner_reload_day",function(){liveliner_day("get_day",$(this).data().day,$(this).data().month,$(this).data().year)}),$(document).on("click","#dashboard_reload_subscriptions",function(){subscriptions_month(iMonth,iYear)}),$(document).on("click","#dashboard_reload_tasks",function(){tasks_active()}),$(document).on("click","#dashboard_reload_cards",function(){cards_active()});