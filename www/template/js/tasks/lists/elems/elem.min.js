function List_elem(t,e,i,s){this.sTemplate=i,this.oBlockWrap=e,this.oBlockListElem={},this.oListElemData=t,this.sEvent=s,this.init=function(){var t=this;$.get(t.sTemplate).fail(function(e){status({error:"Шаблон не найден: "+t.sTemplate})}).done(function(e){if(!e)return!1;$.when(t.oBlockWrap.append(content_loader_elem_html(t.oListElemData,$("<div/>").html(e)))).done(function(){switch(t.oBlockListElem=t.oBlockWrap.find('.block_list_elem[data-id="'+t.oListElemData.id+'"]'),parseInt(t.oListElemData.status)&&t.oBlockListElem.find("._elem_status").addClass("_active_"),t.oBlockListElem.find(".__elem_edit").on("click",function(){t.oBlockListElem.find("._elem_actions").addClass("_active_"),setTimeout(function(){t.oBlockListElem.find("._elem_actions").find(".__elem_title").focus(),t.oBlockListElem.find("._elem_actions").find(".__elem_title").val(t.oBlockListElem.find("._elem_actions").find(".__elem_title").val())},500)}),t.oBlockListElem.find(".__elem_editing").on("click",function(){$(this).parents("._elem_actions").removeClass("_active_"),$.when(content_download({action:"tasks_lists_elems",form:"save",sort:t.oBlockListElem.attr("data-sort"),title:t.oBlockListElem.find(".__elem_title").val(),id:t.oListElemData.id},"json",!1)).then(function(e){if(!e)return!1;e.success&&e.success.data&&t.oBlockListElem.find("._elem_title").html(e.success.data.title)})}),t.oBlockListElem.find("._elem_status .__ok").on("click",function(){$(this).parents("._elem_status").addClass("_active_"),$.when(content_download({action:"tasks_lists_elems",form:"check",status:"1",id:t.oListElemData.id},"json",!1)).then(function(t){if(!t)return!1})}),t.oBlockListElem.find("._elem_status .__no_ok").on("click",function(){$(this).parents("._elem_status").removeClass("_active_"),$.when(content_download({action:"tasks_lists_elems",form:"check",status:"0",id:t.oListElemData.id},"json",!1)).then(function(t){if(!t)return!1})}),t.oBlockListElem.find(".__elem_del").on("click",function(){if(!confirm("Confirm delete"))return!1;$.when(content_download({action:"tasks_lists_elems",form:"del",id:t.oListElemData.id},"json",!1)).then(function(e){if(!e)return!1;sAnimateClass=t.oBlockListElem.data().animate_class?t.oBlockListElem.data().animate_class:"animate__zoomOut",t.oBlockListElem.removeClassWild("animate_*").addClass("animate__animated "+sAnimateClass),setTimeout(function(){t.oBlockListElem.remove()},500)})}),t.sEvent){case"add":t.oBlockListElem.find(".__elem_edit").click()}t.oBlockListElem.find(".__elem_title").keyup(function(e){"Enter"!==e.key&&13!==e.which||t.oBlockListElem.find(".__elem_editing").click()})})})},this.init()}$.fn.list_elem=function(t,e){new List_elem(t,this,"/templates/tasks/lists/elems/elem.htm",e)};