function List(t,i,s,o){this.sTemplate=s,this.oBlockWrap=i,this.oBlockList={},this.oListData=t,this.sEvent=o,this.init=function(){var t=this;$.get(t.sTemplateElem).fail(function(i){status({error:"Шаблон не найден: "+t.sTemplateElem})}).done(function(i){if(!i)return!1;t.oTemplateElem=$("<div/>").html(i)}),$.get(t.sTemplate).fail(function(i){status({error:"Шаблон не найден: "+t.sTemplate})}).done(function(i){if(!i)return!1;$.when(t.oBlockWrap.append(content_loader_elem_html(t.oListData,$("<div/>").html(i)))).done(function(){switch(t.oBlockList=t.oBlockWrap.find('.block_list[data-id="'+t.oListData.id+'"]'),t.oBlockList.find("._list_elems").list_elems(t.oListData),t.oBlockList.find(".__list_edit").on("click",function(){t.oBlockList.find("._list_head_actions").addClass("_active_"),setTimeout(function(){t.oBlockList.find("._list_head_actions").find(".__list_title").focus(),t.oBlockList.find("._list_head_actions").find(".__list_title").val(t.oBlockList.find("._list_head_actions").find(".__list_title").val())},500)}),t.oBlockList.find(".__list_editing").on("click",function(){$(this).parents("._list_head_actions").removeClass("_active_"),$.when(content_download({action:"tasks_lists",form:"save",sort:t.oBlockList.attr("data-sort"),title:t.oBlockList.find(".__list_title").val(),id:t.oListData.id},"json",!1)).then(function(i){if(!i)return!1;i.success&&i.success.data&&t.oBlockList.find("._list_head_title").html(i.success.data.title)})}),t.oBlockList.find(".__list_del").on("click",function(){if(!confirm("Confirm delete"))return!1;$.when(content_download({action:"tasks_lists",form:"del",id:t.oListData.id},"json",!1)).then(function(i){if(!i)return!1;sAnimateClass=t.oBlockList.data().animate_class?t.oBlockList.data().animate_class:"animate__zoomOut",t.oBlockList.removeClassWild("animate_*").addClass("animate__animated "+sAnimateClass),setTimeout(function(){t.oBlockList.remove()},500)})}),o){case"add":t.oBlockList.find(".__list_edit").click()}t.oBlockList.find(".__elem_title").keyup(function(i){"Enter"!==i.key&&13!==i.which||t.oBlockList.find(".__list_editing").click()})})})},this.init()}$.fn.list=function(t,i){new List(t,this,"/templates/tasks/lists/list.htm",i)};